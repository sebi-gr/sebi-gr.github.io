<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>RMF Security Audit Report</title>
  <style>
    body { font-family: -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; color: #24292f; }
    .badge { display:inline-block; padding: 4px 10px; border-radius: 999px; color: white; font-weight: 600; background: #cf222e; }
    .meta { color: #57606a; font-size: 14px; }
    .grid { display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 12px; margin-top: 12px; }
    .kpi { border: 1px solid #d0d7de; border-radius: 10px; padding: 12px; }
    .kpi .v { font-size: 18px; font-weight: 700; }
    .card { border: 1px solid #d0d7de; border-radius: 12px; padding: 10px 12px; margin: 10px 0; }
    summary { cursor: pointer; list-style: none; display:flex; gap:12px; align-items:center; }
    summary::-webkit-details-marker { display:none; }
    .sev { width: 70px; font-weight: 700; }
    .title { flex: 1; font-weight: 600; }
    .right { color:#57606a; font-size: 12px; }
    .body { padding: 10px 2px 2px 2px; }
    code { background:#f6f8fa; padding: 2px 6px; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>RMF Security Audit Report</h1>
  <div class="meta">
    <div><span class="badge">FAIL</span></div>
    <div>Repo: sebi-gr/nist_auditor · PR: 6 · SHA: 6e9493331fc9be304bd320aafc28385a6b191981</div>
    <div>Timestamp (UTC): 2026-02-04T19:37:35+00:00 · Provenance: ai · Profile: ai-aware</div>
    <div>Scope: diff-only · Tools: semgrep</div>
  </div>

  <h2>Executive summary</h2>
  <div class="grid">
    <div class="kpi"><div class="meta">LOC</div><div class="v">1112</div></div>
    <div class="kpi"><div class="meta">Clusters</div><div class="v">3</div></div>
    <div class="kpi"><div class="meta">VD (grouped/KLOC)</div><div class="v">2.7</div></div>
    <div class="kpi"><div class="meta">Compliance score</div><div class="v">65.0</div></div>
  </div>

  <h2>RMF overview</h2>
  <ul>
    <li>Missing owners: 0</li>
    <li>Missing tickets: 0</li>
    <li>Missing SLAs: 0</li>
  </ul>

  <h2>Recommendations</h2>
  <ul><li>Gate failed: resolve blocking findings before merge or document an approved exception with TTL.</li><li>AI-aware profile applied: consider tighter thresholds and increased review for injection/secrets/crypto categories.</li></ul>

  <h2>Finding clusters</h2>
  
<details class="card">
  <summary>
    <span class="sev">HIGH</span>
    <span class="title">sql-injection — root</span>
    <span class="right">FAIL</span>
  </summary>
  <div class="body">
    <p><b>Cluster ID:</b> <code>mod:root|cat:sql-injection|sev:HIGH</code></p>
    <p><b>Location:</b> CodeQlTestServlet.java:19 — <b>Files:</b> CodeQlTestServlet.java</p>
    <p><b>Threat:</b> Injection — <b>Policies:</b> SC-DB-01, SC-INJ-01 — <b>Compliance:</b> violated</p>

    <h4>Measure</h4>
    <ul>
      <li>Tools: semgrep</li>
      <li>Rules: <ul><li><code>java.lang.security.audit.formatted-sql-string.formatted-sql-string</code></li><li><code>java.lang.security.audit.sqli.tainted-sql-from-http-request.tainted-sql-from-http-request</code></li></ul></li>
    </ul>

    <h4>Manage</h4>
    <ul>
      <li>Status: <b>planned</b></li>
      <li>Owner: <b>team-backend</b></li>
      <li>SLA (days): <b>7</b></li>
      <li>Ticket: <b>SEC-1234</b></li>
      <li style="color:#9a6700"></li>
    </ul>

    <h4>Recommended actions</h4>
    <ul><li>Use parameterized queries (PreparedStatement) instead of string formatting/concatenation.</li><li>Validate and constrain user input; avoid passing request parameters directly to SQL sinks.</li><li>Add unit tests for unsafe inputs and regression tests for fixed sinks.</li></ul>

    <h4>Next steps</h4>
    <ul><li>Create ticket and assign owner; fix before next release if severity is high.</li><li>Add targeted review for DB-access layers and request-to-sink flows.</li></ul>
  </div>
</details>

<details class="card">
  <summary>
    <span class="sev">MEDIUM</span>
    <span class="title">weak-crypto-md5 — root</span>
    <span class="right">FAIL</span>
  </summary>
  <div class="body">
    <p><b>Cluster ID:</b> <code>mod:root|cat:weak-crypto-md5|sev:MEDIUM</code></p>
    <p><b>Location:</b> CodeQlTestServlet.java:27 — <b>Files:</b> CodeQlTestServlet.java</p>
    <p><b>Threat:</b> Weak cryptography — <b>Policies:</b> SC-CRYPTO-02 — <b>Compliance:</b> unknown</p>

    <h4>Measure</h4>
    <ul>
      <li>Tools: semgrep</li>
      <li>Rules: <ul><li><code>java.lang.security.audit.crypto.use-of-md5.use-of-md5</code></li></ul></li>
    </ul>

    <h4>Manage</h4>
    <ul>
      <li>Status: <b>planned</b></li>
      <li>Owner: <b>team-backend</b></li>
      <li>SLA (days): <b>30</b></li>
      <li>Ticket: <b>SEC-1250</b></li>
      <li style="color:#9a6700"></li>
    </ul>

    <h4>Recommended actions</h4>
    <ul><li>Replace MD5 with SHA-256 or stronger for hashing; use HMAC (e.g., HmacSHA256) for signatures.</li><li>Ensure cryptographic primitives are used via modern libraries and safe defaults.</li></ul>

    <h4>Next steps</h4>
    <ul><li>Confirm whether the hash is used for security-relevant purposes (passwords/signatures/tokens).</li><li>If security-relevant, prioritize and shorten SLA; otherwise document rationale.</li></ul>
  </div>
</details>

<details class="card">
  <summary>
    <span class="sev">MEDIUM</span>
    <span class="title">weak-crypto-md5 — root</span>
    <span class="right">FAIL</span>
  </summary>
  <div class="body">
    <p><b>Cluster ID:</b> <code>mod:root|cat:weak-crypto-md5|sev:MEDIUM</code></p>
    <p><b>Location:</b> SecurityPitfalls.java:44 — <b>Files:</b> SecurityPitfalls.java</p>
    <p><b>Threat:</b> Weak cryptography — <b>Policies:</b> SC-CRYPTO-02 — <b>Compliance:</b> unknown</p>

    <h4>Measure</h4>
    <ul>
      <li>Tools: semgrep</li>
      <li>Rules: <ul><li><code>java.lang.security.audit.crypto.use-of-md5.use-of-md5</code></li></ul></li>
    </ul>

    <h4>Manage</h4>
    <ul>
      <li>Status: <b>planned</b></li>
      <li>Owner: <b>team-backend</b></li>
      <li>SLA (days): <b>30</b></li>
      <li>Ticket: <b>SEC-1250</b></li>
      <li style="color:#9a6700"></li>
    </ul>

    <h4>Recommended actions</h4>
    <ul><li>Replace MD5 with SHA-256 or stronger for hashing; use HMAC (e.g., HmacSHA256) for signatures.</li><li>Ensure cryptographic primitives are used via modern libraries and safe defaults.</li></ul>

    <h4>Next steps</h4>
    <ul><li>Confirm whether the hash is used for security-relevant purposes (passwords/signatures/tokens).</li><li>If security-relevant, prioritize and shorten SLA; otherwise document rationale.</li></ul>
  </div>
</details>

</body>
</html>
